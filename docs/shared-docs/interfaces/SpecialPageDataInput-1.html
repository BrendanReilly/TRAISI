<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>traisi documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">traisi documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Interfaces</li>
  <li>SpecialPageDataInput</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/survey-viewer-app/app/components/survey-viewer/survey-viewer.component.ts</code>
        </p>



        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#pageHTML">pageHTML</a>
                                </li>
                                <li>
                                        <a href="#pageThemeInfo">pageThemeInfo</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="pageHTML"></a>
                                        <span class="name"><b>pageHTML</b><a href="#pageHTML"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>pageHTML:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="pageThemeInfo"></a>
                                        <span class="name"><b>pageThemeInfo</b><a href="#pageThemeInfo"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>pageThemeInfo:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import {
	Component,
	OnInit,
	ViewChild,
	ViewContainerRef,
	ComponentFactory,
	SystemJsNgModuleLoader,
	Inject,
	ChangeDetectorRef,
	QueryList,
	AfterViewInit,
	AfterContentInit,
	ViewChildren,
	ContentChildren,
	AfterContentChecked,
	AfterViewChecked,
	HostListener,
	ElementRef
} from &#x27;@angular/core&#x27;;
import { SurveyViewerService } from &#x27;../../services/survey-viewer.service&#x27;;
import { QuestionLoaderService } from &#x27;../../services/question-loader.service&#x27;;
import { ActivatedRoute, Params, Router } from &#x27;@angular/router&#x27;;
import { SurveyViewPage } from &#x27;../../models/survey-view-page.model&#x27;;
import { SurveyHeaderDisplayComponent } from &#x27;../survey-header-display/survey-header-display.component&#x27;;
import { sortBy } from &#x27;lodash&#x27;;
import { QuestionContainerComponent } from &#x27;../question-container/question-container.component&#x27;;
import { SurveyQuestion, ResponseValidationState, SurveyRespondent } from &#x27;traisi-question-sdk&#x27;;
import { SurveyViewQuestion } from &#x27;../../models/survey-view-question.model&#x27;;
import { SurveyViewSection } from &#x27;../../models/survey-view-section.model&#x27;;
import { SurveyViewerState } from &#x27;../../models/survey-viewer-state.model&#x27;;
import { SurveyResponderService } from &#x27;../../services/survey-responder.service&#x27;;
import { SurveyViewGroupMember } from &#x27;../../models/survey-view-group-member.model&#x27;;
import { SurveyViewerStateService } from &#x27;../../services/survey-viewer-state.service&#x27;;
import { trigger, state, style, animate, transition, stagger, query, keyframes } from &#x27;@angular/animations&#x27;;
import { SurveyViewerTheme } from &#x27;../../models/survey-viewer-theme.model&#x27;;
import { Header1Component } from &#x27;../special-page-builder/header1/header1.component&#x27;;
import { Header2Component } from &#x27;../special-page-builder/header2/header2.component&#x27;;
import { Footer1Component } from &#x27;../special-page-builder/footer1/footer1.component&#x27;;
import { Utilities } from &#x27;shared/services/utilities&#x27;;
import { SurveyUser } from &#x27;shared/models/survey-user.model&#x27;;
import { SurveyQuestionContainer } from &#x27;../../services/survey-viewer-navigation/survey-question-container&#x27;;
import { SurveyViewerNavigationService } from &#x27;../../services/survey-viewer-navigation/survey-viewer-navigation.service&#x27;;
import { SurveySectionContainer } from &#x27;../../services/survey-viewer-navigation/survey-section-container&#x27;;
import { SurveyGroupContainer } from &#x27;../../services/survey-viewer-navigation/survey-group-container&#x27;;
import { SurveyRepeatContainer } from &#x27;../../services/survey-viewer-navigation/survey-repeat-container&#x27;;
import { SurveySectionRepeatContainer } from &#x27;app/services/survey-viewer-navigation/survey-section-repeat-container&#x27;;
import { SurveyPageContainer } from &#x27;../../services/survey-viewer-navigation/survey-page-container&#x27;;
import { Title } from &#x27;@angular/platform-browser&#x27;;
import { flatMap, share } from &#x27;rxjs/operators&#x27;;
import { zip } from &#x27;rxjs&#x27;;
import { SurveyViewerSession } from &#x27;app/services/survey-viewer-session.service&#x27;;
import { SurveyViewerSessionData } from &#x27;app/models/survey-viewer-session-data.model&#x27;;
import { TooltipDirective } from &#x27;ngx-bootstrap/tooltip/public_api&#x27;;

interface SpecialPageDataInput {
	pageHTML: string;
	pageThemeInfo: string;
}

@Component({
	selector: &#x27;traisi-survey-viewer&#x27;,
	templateUrl: &#x27;./survey-viewer.component.html&#x27;,
	styleUrls: [&#x27;./survey-viewer.component.scss&#x27;],
	animations: [
		trigger(&#x27;visibleHidden&#x27;, [
			/*transition(&#x27;hidden &#x3D;&gt; visible&#x27;, [
				// query(&#x27;:enter&#x27;, style({ opacity: 0 }), { optional: true }),
				// query(&#x27;:leave&#x27;, style({ opacity: 1 }), { optional: true }),
				query(&#x27;:self&#x27;, stagger(&#x27;1s&#x27;, [animate(&#x27;1s&#x27;, keyframes([style({ opacity: 0 }), style({ opacity: 1 })]))]), {
					optional: true
				})
			]), */
			transition(&#x27;* &#x3D;&gt; hidden&#x27;, [
				// query(&#x27;:enter&#x27;, style({ opacity: 0 }), { optional: true }),
				// query(&#x27;:leave&#x27;, style({ opacity: 1 }), { optional: true }),
				query(&#x27;:self&#x27;, stagger(&#x27;1s&#x27;, [animate(&#x27;1s&#x27;, keyframes([style({ opacity: 1 }), style({ opacity: 0, display: &#x27;none&#x27; })]))]), {
					optional: true
				})
			])
		])
	],
	providers: []
})
export class SurveyViewerComponent implements OnInit, AfterViewInit, AfterContentInit, AfterViewChecked {
	public questions: Array&lt;SurveyViewQuestion&gt;;
	public questionTypeMap: { [id: number]: string };
	public questionNameMap: { [name: string]: number };

	public surveyId: number;

	public titleText: string;

	public loadedComponents: boolean &#x3D; false;
	public headerComponent: any;
	public headerHTML: string;
	public headerInputs: SpecialPageDataInput;

	public footerComponent: any;
	public footerHTML: string;
	public footerInputs: SpecialPageDataInput;

	public navButtonClass: string;
	public pageTextColour: string;
	public questionTextColour: string;
	public sectionTitleColour: string;
	public useLightNavigationLines: boolean;

	@ViewChild(SurveyHeaderDisplayComponent)
	public headerDisplay: SurveyHeaderDisplayComponent;

	@ViewChildren(&#x27;questions&#x27;)
	public questionContainers!: QueryList&lt;QuestionContainerComponent&gt;;

	public activeQuestion: any;

	public surveyName: string;

	public session: SurveyViewerSessionData;

	private _activeQuestionContainer: QuestionContainerComponent;

	public ref: SurveyViewerComponent;

	public validationStates: typeof ResponseValidationState &#x3D; ResponseValidationState;

	public get viewerState(): SurveyViewerState {
		return this._viewerStateService.viewerState;
	}

	public set viewerState(viewerState: SurveyViewerState) {
		this._viewerStateService.viewerState &#x3D; viewerState;
	}

	public get isNavigationPreviousEnabled(): boolean {
		return this._navigation.isNavigationPreviousEnabled;
	}

	public pageThemeInfo: any;
	public viewerTheme: SurveyViewerTheme;

	public isShowComplete: boolean &#x3D; false;

	public currentUser: SurveyUser;

	/**
	 * Gets whether is admin
	 */
	public get isAdmin(): boolean {
		if (this.currentUser &#x3D;&#x3D;&#x3D; undefined) {
			return false;
		} else {
			return this.currentUser.roles.includes(&#x27;super administrator&#x27;);
		}
	}

	/**
	 *Creates an instance of SurveyViewerComponent.
	 * @param {SurveyViewerService} surveyViewerService
	 * @param {SurveyResponderService} _surveyResponderService
	 * @param {SurveyViewerStateService} _viewerStateService
	 * @param {SurveyViewerNavigationService} _navigation
	 * @param {SurveyViewerSession} _sessionService
	 * @param {ActivatedRoute} route
	 * @param {Router} _router
	 * @param {Title} _titleService
	 * @param {ElementRef} elementRef
	 * @memberof SurveyViewerComponent
	 */
	constructor(
		@Inject(&#x27;SurveyViewerService&#x27;) private surveyViewerService: SurveyViewerService,
		@Inject(&#x27;SurveyResponderService&#x27;) private _surveyResponderService: SurveyResponderService,
		private _viewerStateService: SurveyViewerStateService,
		private _navigation: SurveyViewerNavigationService,
		private _sessionService: SurveyViewerSession,
		private _route: ActivatedRoute,
		private _router: Router,
		private _titleService: Title,
		private elementRef: ElementRef
	) {
		this.ref &#x3D; this;
		this.viewerState.isLoaded &#x3D; false;
		this.viewerState.isQuestionLoaded &#x3D; false;
	}

	/**
	 * Initialization
	 */
	public ngOnInit(): void {
		console.log(this._route);
		console.log(this._route.children);
		this.currentUser &#x3D; this.surveyViewerService.currentUser;
		this._sessionService.data
			.pipe(
				flatMap((session: SurveyViewerSessionData) &#x3D;&gt; {
					this.session &#x3D; session;
					this.surveyId &#x3D; session.surveyId;
					this.surveyName &#x3D; session.surveyCode;
					this._titleService.setTitle(&#x60;TRAISI - ${session.surveyTitle}&#x60;);
					return this.surveyViewerService.pageThemeInfoJson;
				}),
				share(),
				flatMap((pageTheme: any) &#x3D;&gt; {
					this.pageThemeInfo &#x3D; pageTheme;

					let theme: SurveyViewerTheme &#x3D; {
						sectionBackgroundColour: null,
						questionViewerColour: null,
						viewerTemplate: null
					};
					theme.sectionBackgroundColour &#x3D; pageTheme[&#x27;householdHeaderColour&#x27;];
					theme.questionViewerColour &#x3D; pageTheme[&#x27;questionViewerColour&#x27;];
					theme.viewerTemplate &#x3D; JSON.parse(pageTheme[&#x27;viewerTemplate&#x27;]);

					this.viewerTheme &#x3D; theme;
					theme.viewerTemplate.forEach(sectionInfo &#x3D;&gt; {
						if (sectionInfo.sectionType.startsWith(&#x27;header&#x27;)) {
							this.headerComponent &#x3D; this.getComponent(sectionInfo.sectionType);
							this.headerHTML &#x3D; sectionInfo.html;
						} else if (sectionInfo.sectionType.startsWith(&#x27;footer&#x27;)) {
							this.footerComponent &#x3D; this.getComponent(sectionInfo.sectionType);
							this.footerHTML &#x3D; sectionInfo.html;
						}
					});
					this.elementRef.nativeElement.ownerDocument.body.style.backgroundColor &#x3D; this.pageThemeInfo.pageBackgroundColour;
					this.pageTextColour &#x3D; this.getBestPageTextColour();
					this.questionTextColour &#x3D; this.getBestQuestionBodyTextColor();
					this.sectionTitleColour &#x3D; this.getBestSectionTitleColour();
					this.navButtonClass &#x3D; this.useDarkButtons() ? &#x27;btn-inverse&#x27; : &#x27;btn-default&#x27;;
					this.useLightNavigationLines &#x3D; this.pageTextColour &#x3D;&#x3D;&#x3D; &#x27;rgb(255,255,255)&#x27;;
					this.setComponentInputs();
					this.loadedComponents &#x3D; true;
					return this.surveyViewerService.getSurveyViewPages(this.surveyId);
				}),
				share()
			)
			.subscribe((pages: SurveyViewPage[]) &#x3D;&gt; {
				pages.forEach(page &#x3D;&gt; {
					this.headerDisplay.completedPages.push(false);
				});
				this.loadQuestions(pages);
			});

		this.isShowComplete &#x3D; false;
	}

	/**
	 * Gets component
	 * @param componentName
	 * @returns component
	 */
	private getComponent(componentName: string): any {
		switch (componentName) {
			case &#x27;header1&#x27;:
				return Header1Component;
				break;
			case &#x27;header2&#x27;:
				return Header2Component;
				break;
			case &#x27;footer1&#x27;:
				return Footer1Component;
				break;
			default:
				return null;
				break;
		}
	}

	/**
	 *
	 *
	 * @private
	 * @memberof SurveyViewerComponent
	 */
	private setComponentInputs(): void {
		this.headerInputs &#x3D; {
			pageHTML: this.headerHTML,
			pageThemeInfo: this.pageThemeInfo
		};

		this.footerInputs &#x3D; {
			pageHTML: this.footerHTML,
			pageThemeInfo: this.pageThemeInfo
		};
	}

	/**
	 * Loads questions
	 * @param pages
	 */
	private loadQuestions(pages: Array&lt;SurveyViewPage&gt;): void {
		this._surveyResponderService
			.getSurveyPrimaryRespondent(this.surveyId)
			.pipe(
				flatMap((respondent: SurveyRespondent) &#x3D;&gt; {
					this._surveyResponderService.primaryRespondent &#x3D; {
						id: respondent.id,
						name: null,
						relationship: null
					};
					this.viewerState.primaryRespondent &#x3D; this._surveyResponderService.primaryRespondent;
					return this._surveyResponderService.getSurveyGroupMembers(this._surveyResponderService.primaryRespondent);
				}),
				share()
			)
			.subscribe((members: Array&lt;SurveyViewGroupMember&gt;) &#x3D;&gt; {
				if (members.length &gt; 0) {
					this.viewerState.groupMembers &#x3D; [];
					members.forEach(member &#x3D;&gt; {
						this.viewerState.groupMembers.push(member);
					});
					this.viewerState.primaryRespondent &#x3D; members[0];
					this.viewerState.activeRespondent &#x3D; members[0];
				}

				this.questions &#x3D; [];
				this.questionTypeMap &#x3D; {};
				this.questionNameMap &#x3D; {};
				let pageCount: number &#x3D; 0;
				let viewOrder: number &#x3D; 0;

				this.viewerState.surveyPages &#x3D; [];
				pages.forEach(page &#x3D;&gt; {
					let pageQuestionCount: number &#x3D; 0;
					let pageContainer &#x3D; new SurveyPageContainer(page, this._viewerStateService);
					page.questions.forEach(question &#x3D;&gt; {
						question.pageIndex &#x3D; pageCount;
						question.viewOrder &#x3D; viewOrder;
						question.parentPage &#x3D; page;
						question.viewId &#x3D; Symbol();
						this.questionTypeMap[question.questionId] &#x3D; question.questionType;
						this.questionNameMap[question.name] &#x3D; question.questionId;
						this.questions.push(question);
						pageQuestionCount++;

						if (question.repeatTargets &#x3D;&#x3D;&#x3D; undefined) {
							question.repeatTargets &#x3D; [];
						}

						this.viewerState.questionMap[question.questionId] &#x3D; question;

						if (question.isRepeat) {
							this.viewerState.questionMap[question.repeatSource].repeatTargets.push(question.questionId);
						}

						let sectionRepeatContainer &#x3D; new SurveySectionRepeatContainer(null, this._viewerStateService);

						sectionRepeatContainer.order &#x3D; question.order;

						let groupContainer &#x3D; new SurveyGroupContainer(this._viewerStateService, this.viewerState.primaryRespondent);

						let sectionContainer &#x3D; new SurveySectionContainer(null, this._viewerStateService);

						let repeatContainer &#x3D; new SurveyRepeatContainer(
							question,
							this._viewerStateService,
							this.viewerState.primaryRespondent
						);

						let container &#x3D; new SurveyQuestionContainer(question, sectionContainer);

						repeatContainer.addQuestionContainer(container);

						groupContainer.repeatContainers.push(repeatContainer);

						sectionContainer.groupContainers.push(groupContainer);

						sectionRepeatContainer.children.push(sectionContainer);

						pageContainer.children.push(sectionRepeatContainer);
					});

					page.sections.forEach(section &#x3D;&gt; {
						let inSectionIndex: number &#x3D; 0;
						section.questions.forEach(question &#x3D;&gt; {
							question.pageIndex &#x3D; pageCount;
							question.viewOrder &#x3D; viewOrder;
							question.parentSection &#x3D; section;
							question.inSectionIndex &#x3D; inSectionIndex;
							this.viewerState.questionMap[question.questionId] &#x3D; question;
							question.viewId &#x3D; Symbol();
							this.questionTypeMap[question.questionId] &#x3D; question.questionType;
							this.questionNameMap[question.name] &#x3D; question.questionId;
							this.questions.push(question);
							this.viewerState.sectionMap[section.id] &#x3D; section;
							if (section.isRepeat) {
								this.viewerState.questionMap[section.repeatSource].repeatTargets.push(section.id);
							}
							pageQuestionCount++;
							if (question.repeatTargets &#x3D;&#x3D;&#x3D; undefined) {
								question.repeatTargets &#x3D; [];
							}
							if (question.isRepeat) {
								this.viewerState.questionMap[question.repeatSource].repeatTargets.push(question.questionId);
							}
							inSectionIndex++;

							// try to find existing container
							let sectionContainer: SurveySectionContainer;

							let sectionRepeatContainer: SurveySectionRepeatContainer;

							let index &#x3D; pageContainer.children.findIndex(container2 &#x3D;&gt; {
								if (container2.sectionModel &#x3D;&#x3D;&#x3D; null) {
									return false;
								}
								return container2.containerId &#x3D;&#x3D;&#x3D; question.parentSection.id;
							});

							if (index &lt; 0) {
								sectionRepeatContainer &#x3D; SurveySectionRepeatContainer.CreateSurveySectionRepeatFromModel(
									question.parentSection,
									this._viewerStateService
								);
								sectionContainer &#x3D; sectionRepeatContainer.children[0];
								pageContainer.children.push(sectionRepeatContainer);
							} else {
								sectionRepeatContainer &#x3D; &lt;SurveySectionRepeatContainer&gt;pageContainer.children[index];
								sectionContainer &#x3D; sectionRepeatContainer.children[0];
							}

							sectionRepeatContainer.createQuestionContainer(question, this.viewerState.primaryRespondent);

							sectionContainer.activeGroupContainer.initialize();
						});
					});

					if (pageQuestionCount &gt; 0) {
						this.viewerState.viewContainers.push(pageContainer);
						pageContainer.children &#x3D; sortBy(pageContainer.children, [&#x27;order&#x27;]);
						pageCount +&#x3D; 1;
						this.viewerState.surveyPages.push(page);
					}
				});

				viewOrder &#x3D; 0;
				this.viewerState.viewContainers.forEach(page &#x3D;&gt; {
					page.children.forEach(sectionRepeat &#x3D;&gt; {
						sectionRepeat.children.forEach(section &#x3D;&gt; {
							section.children.forEach(group &#x3D;&gt; {
								group.forRespondent &#x3D; this.viewerState.primaryRespondent;
								group.children.forEach(repeat &#x3D;&gt; {
									repeat.forRespondent &#x3D; this.viewerState.primaryRespondent;
									repeat.children.forEach(question &#x3D;&gt; {
										question.questionModel.repeatTargets &#x3D; Array.from(new Set(question.questionModel.repeatTargets));
										question.forRespondent &#x3D; this.viewerState.primaryRespondent;
										question.questionModel.viewOrder &#x3D; viewOrder;
									});
								});
							});
						});
						viewOrder++;
					});
				});

				this._surveyResponderService.initQuestionIdNameMaps(this._viewerStateService.viewerState);

				this.viewerState.activeQuestionIndex &#x3D; 0;

				this.viewerState.surveyQuestionsFull &#x3D; this.viewerState.surveyQuestions.concat([]);

				this.viewerState.activeQuestionIndex &#x3D; 0;
				this.viewerState.activePageIndex &#x3D; 0;

				this._navigation.navigationCompleted.subscribe(this.navigationCompleted);
				this._navigation.initialize();

				this.viewerState.isLoaded &#x3D; true;
				this.viewerState.isQuestionLoaded &#x3D; true;
			});
	}

	/**
	 * Gets group member completion state
	 * @param groupMemberIndex
	 * @returns true if group member completion state
	 */
	public getGroupMemberCompletionState(groupMemberIndex: number): boolean {
		let currentQ: SurveyQuestionContainer &#x3D; &lt;SurveyQuestionContainer&gt;this.viewerState.activeQuestionContainer;
		if (currentQ !&#x3D;&#x3D; undefined &amp;&amp; currentQ.parentSectionContainer !&#x3D;&#x3D; null) {
			let section &#x3D; currentQ.parentSectionContainer.children[groupMemberIndex];
			return section ? section.isComplete : false;
		} else {
			return false;
		}
	}

	/**
	 *
	 * @param state
	 */
	private onNavigationStateChanged: (state: boolean) &#x3D;&gt; void &#x3D; (newState: boolean) &#x3D;&gt; {};

	/**
	 * Evaluates whether a household question is currently active or not
	 */
	private isHouseholdQuestionActive(): boolean {
		return (
			this.viewerState.isSectionActive &amp;&amp;
			this.viewerState.activeQuestion.parentSection !&#x3D;&#x3D; undefined &amp;&amp;
			this.viewerState.activeQuestion.parentSection.isHousehold
		);
	}

	public updateNavigation(): void {
		let conditionalResult &#x3D; this._viewerStateService.evaluateConditionals(
			this.viewerState.activeQuestion.questionId,
			this.viewerState.isSectionActive &amp;&amp; this.viewerState.activeQuestion.parentSection.isHousehold
				? this.viewerState.groupMembers[this.viewerState.activeGroupMemberIndex].id
				: this.viewerState.primaryRespondent.id
		);

		conditionalResult.subscribe((value: {}) &#x3D;&gt; {
			this._viewerStateService
				.evaluateRepeat(
					this.viewerState.surveyQuestions[this.viewerState.activeQuestionIndex],
					this.viewerState.isSectionActive &amp;&amp; this.viewerState.activeQuestion.parentSection.isHousehold
						? this.viewerState.groupMembers[this.viewerState.activeGroupMemberIndex].id
						: this.viewerState.primaryRespondent.id
				)
				.subscribe((v: {}) &#x3D;&gt; {
					if (!this.validateInternalNavigationNext()) {
					}
				});
		});
	}

	/**
	 * Navigation completed of survey viewer component
	 */
	public navigationCompleted &#x3D; (navStatus: boolean) &#x3D;&gt; {
		this.viewerState.isNavProcessing &#x3D; false;
	};

	/**
	 * Navigates previous
	 */
	public navigatePrevious(): void {
		this.viewerState.isNavProcessing &#x3D; true;
		this._navigation.navigatePrevious();
	}

	/**
	 * Navigates next
	 */
	public navigateNext(): void {
		this.viewerState.isNavProcessing &#x3D; true;
		this._navigation.navigateNext();
	}

	private surveyQuestionsChanged: () &#x3D;&gt; void &#x3D; () &#x3D;&gt; {
		// update the validation based on new survey questions and active question
		// this.validateNavigation();
	};

	/**
	 * Shows group member
	 * @param memberIndex
	 */
	public showGroupMember(memberIndex: number): void {
		const activePage &#x3D; &lt;SurveyPageContainer&gt;this.viewerState.activeViewContainer;

		const activeSection &#x3D; activePage.activeRepeatContainer.activeSection;

		activeSection.setGroupMemberActive(memberIndex);

		this._navigation.updateState();
	}

	/**
	 *
	 */
	private callVisibilityHooks(): void {
		if (this._activeQuestionContainer !&#x3D;&#x3D; undefined) {
			if (this._activeQuestionContainer.surveyQuestionInstance !&#x3D; null) {
				if ((&lt;any&gt;this._activeQuestionContainer.surveyQuestionInstance).__proto__.hasOwnProperty(&#x27;onQuestionShown&#x27;)) {
					(&lt;any&gt;this._activeQuestionContainer.surveyQuestionInstance).onQuestionShown();
				}
			}
		}
	}

	/**
	 * Validates internal navigation next
	 * @returns true if internal navigation next
	 */
	private validateInternalNavigationNext(): boolean {
		if (this._activeQuestionContainer.surveyQuestionInstance !&#x3D; null) {
			// console.log(&#x27;navigate: &#x27; + this._activeQuestionContainer.surveyQuestionInstance.canNavigateInternalNext());
			return this._activeQuestionContainer.surveyQuestionInstance.canNavigateInternalNext();
		}

		return false;
	}

	/**
	 * Validates the disabled / enabled state of the navigation buttons.
	 */
	public validateNavigation(): void {
		return;
	}

	private activeRespondentId(): number {
		if (this.isHouseholdQuestionActive()) {
			return this.viewerState.groupMembers[this.viewerState.activeGroupMemberIndex].id;
		} else {
			return this.viewerState.primaryRespondent.id;
		}
	}

	private retrieveHouseholdTag(): string {
		let questionId: number &#x3D; +Object.keys(this.questionTypeMap).find(key &#x3D;&gt; this.questionTypeMap[key] &#x3D;&#x3D;&#x3D; &#x27;household&#x27;);
		return Object.keys(this.questionNameMap).find(key &#x3D;&gt; this.questionNameMap[key] &#x3D;&#x3D;&#x3D; questionId);
	}

	public processedSectionLabel(sectionTitle: string): string {
		return Utilities.replacePlaceholder(sectionTitle, this.retrieveHouseholdTag(), this.viewerState.activeRespondent.name);
	}

	/**
	 *
	 */
	public ngAfterViewInit(): void {
		this.questionContainers.changes.subscribe(s &#x3D;&gt; {
			this._activeQuestionContainer &#x3D; s.first;

			if (s.length &gt; 1) {
			}

			setTimeout(() &#x3D;&gt; {
				this.callVisibilityHooks();
				this.validateNavigation();
			});
		});
	}

	/**
	 * Navigates complete survey
	 */
	public navigateCompleteSurvey(): void {
		console.log(&#x27;navigate to thankyou page &#x27;);

		this._router.navigate([this.surveyName, &#x27;thankyou&#x27;]);
	}

	public ngAfterContentInit(): void {}

	public ngAfterViewChecked(): void {}

	/**
	 * Uses dark buttons
	 * @returns true if dark buttons
	 */
	private useDarkButtons(): boolean {
		return this.pageTextColour !&#x3D;&#x3D; &#x27;rgb(0,0,0)&#x27;;
	}

	/**
	 * Gets best page text colour
	 * @returns best page text colour
	 */
	private getBestPageTextColour(): string {
		if (this.pageThemeInfo.pageBackgroundColour) {
			return Utilities.whiteOrBlackText(this.pageThemeInfo.pageBackgroundColour);
		} else {
			return &#x27;rgb(0,0,0)&#x27;;
		}
	}

	private getBestSectionTitleColour(): string {
		if (this.pageThemeInfo.pageBackgroundColour) {
			return Utilities.whiteOrBlackText(this.viewerTheme.sectionBackgroundColour);
		} else {
			return &#x27;rgb(0,0,0)&#x27;;
		}
	}

	/**
	 * Gets best question body text color
	 * @returns best question body text color
	 */
	private getBestQuestionBodyTextColor(): string {
		if (this.pageThemeInfo.questionViewerColour) {
			return Utilities.whiteOrBlackText(this.pageThemeInfo.questionViewerColour);
		} else {
			return &#x27;rgb(0,0,0)&#x27;;
		}
	}

	// public onQuestionScroll($event) {}
}
</code></pre>
    </div>
</div>






                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'SpecialPageDataInput-1.html';
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
